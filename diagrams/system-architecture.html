<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popcorn E-commerce - System Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 40px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        .diagram-container {
            background: #fafafa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #e0e0e0;
            overflow-x: auto;
        }
        .architecture-section {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
        }
        .architecture-section h3 {
            color: #2c3e50;
            margin-top: 0;
        }
        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .tech-category {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .tech-category h4 {
            color: #2c3e50;
            margin-top: 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .tech-category ul {
            margin: 10px 0;
        }
        .tech-category li {
            margin: 8px 0;
            padding: 5px 0;
        }
        .tech-item {
            font-weight: bold;
            color: #e74c3c;
        }
        .deployment-info {
            background: #fff3cd;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            margin-top: 30px;
        }
        .deployment-info h3 {
            color: #856404;
            margin-top: 0;
        }
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .feature-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .feature-card h4 {
            color: #2c3e50;
            margin-top: 0;
        }
        .mermaid {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèóÔ∏è Popcorn E-commerce Platform</h1>
        <h2>System Architecture Overview</h2>
        
        <div class="diagram-container">
            <div class="mermaid">
graph TB
    subgraph "Frontend Layer"
        UI[Next.js Frontend<br/>React 19 + TypeScript]
        CHAT[Chat Widget<br/>AI Interface]
        DASH[Dashboard<br/>Product Grid]
        AUTH[Auth Pages<br/>Signin/Signup]
    end

    subgraph "API Layer"
        API[Next.js API Routes<br/>Serverless Functions]
        AUTHAPI[NextAuth API<br/>Authentication]
        CHATAPI[AI Chat API<br/>OpenAI Integration]
        PRODAPI[Product API<br/>CRUD Operations]
    end

    subgraph "Service Layer"
        AISERVICE[AI Service<br/>GPT-4 Integration]
        USERSERVICE[User Service<br/>User Management]
        PRODSERVICE[Product Service<br/>Catalog Management]
        CONVSERVICE[Conversation Service<br/>Chat History]
        MSGSERVICE[Message Service<br/>Message Storage]
    end

    subgraph "Data Layer"
        REPO[Repository Layer<br/>TypeORM Repositories]
        DB[(MySQL Database<br/>Product & User Data)]
    end

    subgraph "External Services"
        OPENAI[OpenAI API<br/>GPT-4 Chat]
        DOCKER[Docker Containers<br/>Production Deployment]
    end

    %% Frontend to API connections
    UI --> API
    CHAT --> CHATAPI
    DASH --> PRODAPI
    AUTH --> AUTHAPI

    %% API to Service connections
    API --> AISERVICE
    API --> USERSERVICE
    API --> PRODSERVICE
    API --> CONVSERVICE
    API --> MSGSERVICE

    %% Service to Repository connections
    AISERVICE --> REPO
    USERSERVICE --> REPO
    PRODSERVICE --> REPO
    CONVSERVICE --> REPO
    MSGSERVICE --> REPO

    %% Repository to Database
    REPO --> DB

    %% External service connections
    AISERVICE --> OPENAI
    API --> DOCKER

    %% Styling
    classDef frontend fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef api fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef service fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef data fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef external fill:#ffebee,stroke:#d32f2f,stroke-width:2px

    class UI,CHAT,DASH,AUTH frontend
    class API,AUTHAPI,CHATAPI,PRODAPI api
    class AISERVICE,USERSERVICE,PRODSERVICE,CONVSERVICE,MSGSERVICE service
    class REPO,DB data
    class OPENAI,DOCKER external
            </div>
        </div>

        <div class="architecture-section">
            <h3>üèõÔ∏è Architecture Overview</h3>
            <p>The Popcorn e-commerce platform follows a <strong>layered architecture</strong> with clear separation of concerns:</p>
            <ul>
                <li><strong>Frontend Layer:</strong> Next.js with React 19 and TypeScript for modern UI</li>
                <li><strong>API Layer:</strong> Serverless functions handling HTTP requests</li>
                <li><strong>Service Layer:</strong> Business logic and external service integration</li>
                <li><strong>Data Layer:</strong> TypeORM repositories and MySQL database</li>
                <li><strong>External Services:</strong> OpenAI API and Docker deployment</li>
            </ul>
        </div>

        <h2>üõ†Ô∏è Technology Stack</h2>
        <div class="tech-stack">
            <div class="tech-category">
                <h4>üé® Frontend</h4>
                <ul>
                    <li><span class="tech-item">Next.js 15.5.3</span> - React framework with App Router</li>
                    <li><span class="tech-item">React 19.1.0</span> - UI library with latest features</li>
                    <li><span class="tech-item">TypeScript 5</span> - Type-safe development</li>
                    <li><span class="tech-item">Tailwind CSS 4</span> - Utility-first styling</li>
                    <li><span class="tech-item">Lucide React</span> - Icon library</li>
                </ul>
            </div>

            <div class="tech-category">
                <h4>‚öôÔ∏è Backend</h4>
                <ul>
                    <li><span class="tech-item">Next.js API Routes</span> - Serverless functions</li>
                    <li><span class="tech-item">NextAuth.js 4.24.11</span> - Authentication</li>
                    <li><span class="tech-item">TypeORM 0.3.27</span> - Database ORM</li>
                    <li><span class="tech-item">MySQL 8.0</span> - Primary database</li>
                    <li><span class="tech-item">bcryptjs</span> - Password hashing</li>
                </ul>
            </div>

            <div class="tech-category">
                <h4>ü§ñ AI Integration</h4>
                <ul>
                    <li><span class="tech-item">OpenAI 5.21.0</span> - GPT-4 integration</li>
                    <li><span class="tech-item">Function Calling</span> - Product search capabilities</li>
                    <li><span class="tech-item">Rich Content</span> - Product carousel rendering</li>
                    <li><span class="tech-item">Context Management</span> - Conversation history</li>
                </ul>
            </div>

            <div class="tech-category">
                <h4>üê≥ Infrastructure</h4>
                <ul>
                    <li><span class="tech-item">Docker</span> - Containerization</li>
                    <li><span class="tech-item">Docker Compose</span> - Multi-container orchestration</li>
                    <li><span class="tech-item">Standalone Next.js</span> - Production optimization</li>
                    <li><span class="tech-item">Health Checks</span> - Service monitoring</li>
                </ul>
            </div>
        </div>

        <h2>‚ú® Key Features</h2>
        <div class="features-grid">
            <div class="feature-card">
                <h4>ü§ñ AI Shopping Assistant</h4>
                <p>GPT-4 powered chat interface that helps customers find products through natural conversation</p>
            </div>
            <div class="feature-card">
                <h4>üõçÔ∏è Product Catalog</h4>
                <p>Comprehensive product management with categories, search, and filtering capabilities</p>
            </div>
            <div class="feature-card">
                <h4>üîê User Authentication</h4>
                <p>Secure login/signup with NextAuth, JWT tokens, and role-based access control</p>
            </div>
            <div class="feature-card">
                <h4>üí¨ Real-time Chat</h4>
                <p>Instant AI responses with rich content including product carousels and images</p>
            </div>
            <div class="feature-card">
                <h4>üì± Responsive Design</h4>
                <p>Mobile-first approach with Tailwind CSS for optimal user experience</p>
            </div>
            <div class="feature-card">
                <h4>üé† Rich Content</h4>
                <p>AI-generated product carousels with interactive "Add to Cart" functionality</p>
            </div>
            <div class="feature-card">
                <h4>üóÑÔ∏è Data Persistence</h4>
                <p>TypeORM with MySQL for reliable data storage and retrieval</p>
            </div>
            <div class="feature-card">
                <h4>üöÄ Production Ready</h4>
                <p>Docker containerization with health checks and monitoring</p>
            </div>
        </div>

        <h2>üîÑ Data Flow Architecture</h2>
        <div class="diagram-container">
            <div class="mermaid">
graph LR
    subgraph "User Interaction"
        U[User] --> UI[Frontend UI]
    end

    subgraph "Request Processing"
        UI --> API[API Routes]
        API --> AUTH[Authentication]
        API --> VALID[Validation]
    end

    subgraph "Business Logic"
        VALID --> SERVICE[Service Layer]
        SERVICE --> AI[AI Service]
        SERVICE --> DATA[Data Service]
    end

    subgraph "External Integration"
        AI --> OPENAI[OpenAI API]
        DATA --> DB[(MySQL Database)]
    end

    subgraph "Response Generation"
        OPENAI --> RICH[Rich Content]
        DB --> ENTITY[Entity Objects]
        RICH --> RESPONSE[API Response]
        ENTITY --> RESPONSE
    end

    subgraph "UI Rendering"
        RESPONSE --> UI
        UI --> RENDER[Component Rendering]
        RENDER --> U
    end

    %% Styling
    classDef user fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef process fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef business fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef external fill:#ffebee,stroke:#d32f2f,stroke-width:2px
    classDef response fill:#fff3e0,stroke:#f57c00,stroke-width:2px

    class U,UI user
    class API,AUTH,VALID process
    class SERVICE,AI,DATA business
    class OPENAI,DB external
    class RICH,ENTITY,RESPONSE,RENDER response
            </div>
        </div>

        <div class="deployment-info">
            <h3>üöÄ Deployment Architecture</h3>
            <p>The application is designed for <strong>containerized deployment</strong> with the following characteristics:</p>
            <ul>
                <li><strong>Docker Containers:</strong> Application and MySQL database in separate containers</li>
                <li><strong>Docker Compose:</strong> Orchestrates multi-container deployment</li>
                <li><strong>Health Checks:</strong> Monitors service availability and database connectivity</li>
                <li><strong>Environment Configuration:</strong> Environment-based settings for different deployment stages</li>
                <li><strong>Data Persistence:</strong> MySQL data persisted in Docker volumes</li>
                <li><strong>Production Optimization:</strong> Standalone Next.js output for minimal container size</li>
            </ul>
        </div>

        <div class="architecture-section">
            <h3>üîí Security & Performance</h3>
            <ul>
                <li><strong>Authentication:</strong> JWT-based sessions with NextAuth.js</li>
                <li><strong>Password Security:</strong> bcryptjs for password hashing</li>
                <li><strong>Input Validation:</strong> Comprehensive validation at API and service layers</li>
                <li><strong>Database Security:</strong> TypeORM with parameterized queries</li>
                <li><strong>Performance:</strong> Next.js optimization with standalone output</li>
                <li><strong>Scalability:</strong> Stateless API design for horizontal scaling</li>
            </ul>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#3498db',
                primaryTextColor: '#2c3e50',
                primaryBorderColor: '#2980b9',
                lineColor: '#34495e',
                secondaryColor: '#ecf0f1',
                tertiaryColor: '#f8f9fa'
            }
        });
    </script>
</body>
</html>